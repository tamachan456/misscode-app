<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
<title>ãƒŸã‚¹ã‚³ãƒ¼ãƒ‰å…¥åŠ›_æ–‡å­—ã‚µã‚¤ã‚ºæœ€å¤§åŒ–ç‰ˆ</title>

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#4a5d73">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

<style>
:root {
    --bg-a: linear-gradient(135deg, #4a5d73, #66788f);
    --bg-b: linear-gradient(135deg, #7a5c5c, #967676);
    --color-a: #2e75b6;
    --color-b: #c00000;
}

* {
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    user-select: none;
    -webkit-tap-highlight-color: transparent;
    box-sizing: border-box;
}

body {
    margin: 0;
    font-family: "Helvetica Neue", Arial, "Hiragino Kaku Gothic ProN", "Hiragino Sans", sans-serif;
    overflow: hidden;
    color: #f0f0f0;
    height: 100dvh;
    background: var(--bg-a);
}

body.player-b-mode { background: var(--bg-b); }

/* --- æ¨ªå‘ãè­¦å‘Šç”»é¢ --- */
#orientation-lock {
    display: none;
    position: fixed;
    top: 0; left: 0; width: 100%; height: 100%;
    background: #000;
    color: #fff;
    z-index: 10000;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
}
@media screen and (orientation: landscape) {
    #orientation-lock { display: flex; }
    .container { display: none; }
}
@media screen and (orientation: portrait) {
    #orientation-lock { display: none; }
    .container { display: flex; }
}

.container {
    display: flex; /* åˆæœŸçŠ¶æ…‹ã‚’flexã« */
    flex-direction: column;
    height: 100dvh;
    padding: 6px;
}

.header-info {
    text-align: center;
    font-size: 16px;
    font-weight: bold;
    margin-bottom: 4px;
    background: rgba(0, 0, 0, 0.25);
    border-radius: 5px;
    padding: 4px;
}

.output {
    background: rgba(255, 255, 255, 0.95);
    color: #222;
    border-radius: 10px;
    padding: 8px;
    font-size: 24px;
    font-weight: bold;
    height: 70px; 
    box-shadow: 0 4px 10px rgba(0,0,0,0.2);
    white-space: pre-wrap;
    word-break: break-all;
    margin-bottom: 6px;
    overflow-y: auto;
}

.bar {
    display: flex;
    gap: 6px;
    margin-bottom: 6px;
}
.bar button {
    flex: 1;
    padding: 10px;
    border: none;
    border-radius: 8px;
    font-size: 16px;
    font-weight: bold;
    color: #fff;
    background: #555;
}

.btn-undo-a { background: var(--color-a) !important; }
.btn-undo-b { background: var(--color-b) !important; }
button.disabled-undo { opacity: 0.15 !important; filter: grayscale(1); pointer-events: none; }

.content-area { flex: 1; overflow: hidden; }
.player-panel { display: none; height: 100%; }
.player-panel.active { display: block; }

.sections {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 4px;
    height: 100%;
}

.section {
    background: rgba(255,255,255,0.12);
    border: 1px solid rgba(255,255,255,0.15);
    border-radius: 8px;
    padding: 2px;
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
}

.section-title {
    font-size: 16px;
    padding: 2px 0;
    margin-bottom: 2px;
    border-bottom: 2px solid rgba(255,255,255,0.3);
    color: #ffeb3b;
    text-align: center;
    font-weight: 900;
    letter-spacing: 1px;
}

.btn-item {
    display: flex;
    flex-direction: row-reverse;
    align-items: center;
    justify-content: flex-end;
    gap: 4px;
    padding: 4px 1px;
    flex: 1
    padding-right: 15px;
}

.code-btn {
    width: 48px;
    height: 48px;
    min-width: 48px;
    border-radius: 50%;
    border: 1px solid rgba(255,255,255,0.2);
    font-size: 24px;
    font-weight: 900;
    color: #fff;
    background: linear-gradient(145deg, #555, #1a1a1a);
    box-shadow: inset 2px 2px 4px rgba(255,255,255,0.15), 2px 4px 6px rgba(0,0,0,0.4);
    display: flex; justify-content: center; align-items: center;
}

.code-label {
    font-size: 15px;
    font-weight: 900;
    color: #fff;
    line-height: 1.0;
    text-align: right;
    flex: 1;
    white-space: pre-line;
    text-shadow: 2px 2px 3px rgba(0,0,0,0.8);
}

.code-btn.flash {
    background: #ffd600 !important;
    color: #000 !important;
    box-shadow: 0 0 20px 10px #ffd600 !important;
}

.footer-nav { display: flex; gap: 12px; height: 85px; padding-top: 6px; }
.nav-btn { flex: 1; border: 3px solid rgba(255,255,255,0.2); border-radius: 18px; font-size: 28px; font-weight: bold; color: #fff; opacity: 0.4; }
.nav-btn.active { opacity: 1; border-color: #fff; }
.btnA { background: linear-gradient(145deg, #3a7ab3, #254d71); }
.btnB { background: linear-gradient(145deg, #a63a3a, #712525); }

</style>
</head>

<body id="mainBody" oncontextmenu="return false;">

<div id="orientation-lock">
    <div style="font-size: 50px; margin-bottom: 10px;">ğŸ”„</div>
    <p style="font-size: 20px; font-weight: bold;">ç”»é¢ã‚’ç¸¦å‘ãã«æˆ»ã—ã¦ãã ã•ã„</p>
    <button style="margin-top:20px; padding:15px; border-radius:20px; border:none;" onclick="forcePortraitRestore()">å¾©å¸°ã™ã‚‹</button>
</div>

<div class="container" id="appContainer">
    <div class="header-info" id="statusLabel">å¤ªæ¥µæ‹³,å‰£ç”¨ãƒŸã‚¹ã‚³ãƒ¼ãƒ‰å…¥åŠ›ã€€ã€Aé¸æ‰‹ã€‘</div>
    <div id="sharedOutput" class="output">A: <br>B: </div>

    <div class="bar">
        <button onclick="resetAll()">å…¨ãƒªã‚»ãƒƒãƒˆ</button>
        <button id="undoA" class="btn-undo-a" onclick="undo('A')">Aæ¶ˆã™</button>
        <button id="undoB" class="btn-undo-b disabled-undo" onclick="undo('B')">Bæ¶ˆã™</button>
    </div>

    <div class="content-area">
        <div id="panelA" class="player-panel active">
            <div class="sections" id="Asections"></div>
        </div>
        <div id="panelB" class="player-panel">
            <div class="sections" id="Bsections"></div>
        </div>
    </div>

    <div class="footer-nav">
        <button id="navA" class="nav-btn btnA active" onclick="switchPlayer('A')">Aé¸æ‰‹</button>
        <button id="navB" class="nav-btn btnB" onclick="switchPlayer('B')">Bé¸æ‰‹</button>
    </div>
</div>

<script>
let codes = { A: [], B: [] };
let currentPlayer = 'A';

const sectionsData = [
    {title:"å™¨æ¢°", items:[{c:73, n:"è§¦ã‚Œã‚‹\nå½“ãŸã‚‹"}, {c:74, n:"åˆ‡æ–­"}, {c:75, n:"è½ä¸‹"}]},
    {title:"ãã®ä»–", items:[{c:77, n:"é™æ­¢\næ™‚é–“"}, {c:78, n:"ã‚³ãƒ¼ãƒˆå¤–"}, {c:79, n:"å¿˜å´"}]},
    {title:"å‰£æ³•ãƒ»æœé£¾", items:[{c:60, n:"æ›å‰£\næ’©å‰£"}, {c:61, n:"æ¡å‰£"}, {c:76, n:"æœé£¾\nä¸å‚™"}]},
    {title:"è…¿æ³•", items:[{c:24, n:"åˆ†è„š\nè¹¬è„š"}, {c:25, n:"æ“ºè“®è„š"}, {c:26, n:"æ‹è„š"}]},
    {title:"æ­©å‹æ­©æ³•", items:[{c:50, n:"å¼“æ­©"}, {c:53, n:"ä»†æ­©"}, {c:54, n:"æ­©å‹\næ­©æ³•"}]},
    {title:"ãƒãƒ©ãƒ³ã‚¹", items:[{c:70, n:"ã‚†ã‚Œ\nç§»å‹•"}, {c:71, n:"é™„åŠ \næ”¯æŒ"}, {c:72, n:"å€’ã‚Œã‚‹"}]}
];

function buildUI(player) {
    let html = "";
    sectionsData.forEach(sec => {
        html += `<div class="section"><div class="section-title">${sec.title}</div>`;
        sec.items.forEach(item => {
            html += `<div class="btn-item" onclick="addCode('${player}', ${item.c}, this.querySelector('.code-btn'))"><button class="code-btn">${item.c}</button><div class="code-label">${item.n}</div></div>`;
        });
        html += `</div>`;
    });
    document.getElementById(player + "sections").innerHTML = html;
}
buildUI("A"); buildUI("B");

function switchPlayer(p) {
    currentPlayer = p;
    document.getElementById('undoA').classList.toggle('disabled-undo', p !== 'A');
    document.getElementById('undoB').classList.toggle('disabled-undo', p !== 'B');
    document.getElementById('mainBody').classList.toggle('player-b-mode', p === 'B');
    document.getElementById('statusLabel').innerText = "å¤ªæ¥µæ‹³,å‰£ç”¨ãƒŸã‚¹ã‚³ãƒ¼ãƒ‰å…¥åŠ›ã€€ã€" + p + "é¸æ‰‹ã€‘";
    document.getElementById('panelA').style.display = (p === 'A') ? 'block' : 'none';
    document.getElementById('panelB').style.display = (p === 'B') ? 'block' : 'none';
    document.getElementById('navA').classList.toggle('active', p === 'A');
    document.getElementById('navB').classList.toggle('active', p === 'B');
}

function forcePortraitRestore() {
    window.scrollTo(0, 0);
    document.getElementById('orientation-lock').style.display = 'none';
    document.getElementById('appContainer').style.display = 'flex';
    switchPlayer(currentPlayer);
}

function addCode(p, c, btn) {
    codes[p].push(c);
    updateDisplay();
    btn.classList.add("flash");
    setTimeout(() => btn.classList.remove("flash"), 250);
}

function undo(p) { codes[p].pop(); updateDisplay(); }

function resetAll() {
    if (confirm("å…¨ã¦ã®ãƒ‡ãƒ¼ã‚¿ã‚’æ¶ˆå»ã—ã¾ã™ã‹ï¼Ÿ")) {
        codes = { A: [], B: [] };
        updateDisplay();
    }
}

function updateDisplay() {
    const out = document.getElementById("sharedOutput");
    out.innerText = "A: " + codes.A.join(",") + "\nB: " + codes.B.join(",");
    out.scrollTop = out.scrollHeight;
}

window.addEventListener('orientationchange', () => { setTimeout(forcePortraitRestore, 300); });

/* â˜… Service Worker ç™»éŒ² */
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('./sw.js')
    .then(() => console.log("Service Worker Registered"))
    .catch(err => console.log("SW Register Error:", err));
}
</script>
</body>
</html>
